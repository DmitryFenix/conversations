# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose up -d api redis worker

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
docker compose run --rm tests
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
./run_tests.sh
```

## üìã –í–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞

### 1. Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞
- ‚úÖ –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ API —á–µ—Ä–µ–∑ Docker —Å–µ—Ç—å
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–∞ —Ö–æ—Å—Ç
- ‚úÖ –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
# –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
docker compose run --rm tests

# –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ (watch mode)
./run_tests_continuous.sh

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
docker compose run --rm tests pytest test_api.py::TestSessionCreation -v
```

### 2. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Python 3.11+
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r tests/requirements.txt`
- –ó–∞–ø—É—â–µ–Ω–Ω—ã–π API —Å–µ—Ä–≤–µ—Ä –Ω–∞ `http://localhost:8000`

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
# –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç (–±–µ–∑ pytest)
python tests/test_manual.py

# –° pytest
pytest tests/test_api.py -v

# –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
python tests/run_tests.py
```

### 3. CI/CD (GitHub Actions)

–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–∏:
- Push –≤ `main`, `master`, `develop`
- Pull Request –≤ —ç—Ç–∏ –≤–µ—Ç–∫–∏
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub Actions UI

–°–º. `.github/workflows/tests.yml`

## üß™ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π —Ä–µ–≤—å—é–µ—Ä–æ–º
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- ‚úÖ –î–æ—Å—Ç—É–ø –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –ø–æ —Ç–æ–∫–µ–Ω—É
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- ‚úÖ –°–∏–≥–Ω–∞–ª –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
- ‚úÖ –ó–∞–ø—É—Å–∫ –æ—Ü–µ–Ω–∫–∏ —Å–µ—Å—Å–∏–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Gitea
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ Gitea –≤ —Å–µ—Å—Å–∏–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ Pull Request
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ PR
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–∑ Gitea

### –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ diff —Å–µ—Å—Å–∏–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tests/
‚îú‚îÄ‚îÄ Dockerfile              # –û–±—Ä–∞–∑ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ conftest.py            # –§–∏–∫—Å—Ç—É—Ä—ã pytest
‚îú‚îÄ‚îÄ test_api.py            # –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ test_manual.py          # –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (–±–µ–∑ pytest)
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ README_DOCKER.md       # Docker –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ run_in_docker.sh       # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤ Docker

docker-compose.test.yml     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
.github/workflows/tests.yml # CI/CD pipeline
run_tests.sh                # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
run_tests_continuous.sh     # –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `API_BASE_URL` - URL API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `http://localhost:8000` –∏–ª–∏ `http://api:8000` –≤ Docker)
- `TEST_INTERVAL` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ –≤ watch mode (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 —Å–µ–∫—É–Ω–¥)

### –í Docker

```bash
# –£–∫–∞–∑–∞—Ç—å –¥—Ä—É–≥–æ–π URL API
docker compose run --rm -e API_BASE_URL=http://api:8000 tests

# –ò–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª
TEST_INTERVAL=5 ./run_tests_continuous.sh
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–¢–µ—Å—Ç—ã –≤—ã–≤–æ–¥—è—Ç:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚úó –ù–µ—É–¥–∞—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
- ‚ö† –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ —É—Å–ª–æ–≤–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, Gitea –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã
docker compose ps

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose up -d api redis worker

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose logs api
```

### –¢–µ—Å—Ç—ã –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç API
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `API_BASE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –í Docker –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `http://api:8000`
- –õ–æ–∫–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `http://localhost:8000`

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
```bash
# –í Docker (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ)
docker compose build tests

# –õ–æ–∫–∞–ª—å–Ω–æ
pip install -r tests/requirements.txt
```

## üîÑ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö:

```bash
# Docker
./run_tests_continuous.sh

# –õ–æ–∫–∞–ª—å–Ω–æ
python tests/run_tests.py
```

–¢–µ—Å—Ç—ã –±—É–¥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10).

## üìù –ú–µ—Ç–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–º–µ—Ç–æ–¥ —á—ë—Ä–Ω–æ–≥–æ —è—â–∏–∫–∞ (Black Box Testing)**:
- –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–æ–ª—å–∫–æ HTTP endpoints
- –ù–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ –ª—é–±–æ–≥–æ API, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ —Ç–µ –∂–µ endpoints

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è edge cases
2. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å coverage reports
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ CI/CD —Å–∏—Å—Ç–µ–º–∞–º–∏

