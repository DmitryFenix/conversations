# Обновление фронтенда для выбора MR - ЗАВЕРШЕНО ✅

## Что реализовано

### 1. Новый компонент `MRSelector.jsx`

Компонент для выбора Merge Requests с функциями:

- ✅ **Рекомендации на основе грейда**:
  - Выбор грейда (Junior/Middle/Senior)
  - Ввод тегов стека
  - Кнопка "Получить рекомендации"
  - Автоматический подбор MR для целевого диапазона баллов

- ✅ **Фильтрация MR**:
  - По типу (bugfix, feature, refactoring, tests, performance, security, infrastructure, code_style)
  - По баллам сложности (мин/макс)
  - По тегам стека
  - Поиск по названию и описанию

- ✅ **Визуализация**:
  - Прогресс-бар выбранных баллов
  - Цветовая индикация типов MR
  - Отображение тегов стека
  - Индикация соответствия целевому грейду

- ✅ **Интерактивность**:
  - Чекбоксы для выбора MR
  - Кнопка "Выбрать все" для рекомендаций
  - Очистка фильтров
  - Поддержка тёмной темы

### 2. Интеграция в `ReviewerDashboard.jsx`

- ✅ Добавлен импорт `MRSelector`
- ✅ Добавлено поле `mr_ids` в состояние `newSession`
- ✅ Компонент встроен в форму создания сессии
- ✅ Выбранные MR отправляются на сервер при создании сессии

## Как использовать

### 1. Создание сессии с выбором MR

1. Нажмите "Создать новую сессию"
2. Заполните имя кандидата и другие поля
3. В секции "Выбор Merge Requests":
   - Выберите грейд (Junior/Middle/Senior)
   - Введите теги стека (например: `python,backend`)
   - Нажмите "Рекомендации" для автоматического подбора
   - Или используйте фильтры для ручного выбора
4. Выберите нужные MR (чекбоксы)
5. Нажмите "Создать сессию"

### 2. Рекомендации

Система автоматически подберёт MR для достижения целевого диапазона баллов:
- **Junior**: 3-4 балла
- **Middle**: 5-7 баллов
- **Senior**: 8-10 баллов

### 3. Фильтрация

- **Тип MR**: выберите из выпадающего списка
- **Баллы**: укажите минимальное и максимальное значение (1-5)
- **Поиск**: введите ключевые слова для поиска по названию/описанию

## API Endpoints

Компонент использует следующие endpoints:

- `GET /api/mr/list` - список MR с фильтрацией
- `GET /api/mr/recommend` - рекомендации на основе грейда
- `POST /api/reviewer/sessions` - создание сессии с `mr_ids`

## Проверка статистики MR

Для проверки количества MR в базе:

```bash
# Через скрипт (в Docker)
docker compose exec api python scripts/check_mr_stats.py

# Или через API
curl "http://localhost:8000/api/mr/list" | jq '.total'
```

## Откуда берутся MR

MR собираются из двух источников:

1. **Локальные Git репозитории** - через `scripts/collect_mrs.py`
2. **Артефакты сессий** - из `/artifacts/*_diff.patch`

При сборе MR автоматически классифицируются по:
- Типу (на основе ключевых слов)
- Баллам сложности (1-5, на основе размера и типа)
- Тегам стека (на основе языка и ключевых слов)

## Следующие шаги

1. ✅ Компонент выбора MR создан
2. ✅ Интеграция в форму завершена
3. ⏳ Собрать MR в базу данных (если ещё не собраны)
4. ⏳ Протестировать создание сессии с выбранными MR

## Пример использования

```javascript
// В форме создания сессии
<MRSelector
  selectedMRIds={newSession.mr_ids || []}
  onSelectionChange={(mrIds) => setNewSession({ ...newSession, mr_ids: mrIds })}
  theme={theme}
/>

// При создании сессии
const response = await axios.post('/api/reviewer/sessions', {
  candidate_name: 'Иван Иванов',
  mr_package: 'demo_package',
  reviewer_name: 'Reviewer',
  mr_ids: [1, 3, 5]  // Выбранные MR
})
```

## Визуальные элементы

- **Прогресс-бар**: показывает выбранные баллы и соответствие целевому грейду
- **Цветовая индикация типов**: каждый тип MR имеет свой цвет
- **Теги стека**: отображаются как бейджи
- **Рекомендации**: выделяются отдельной секцией с кнопкой "Выбрать все"




