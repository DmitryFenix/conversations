# Метрики для выбора Merge Requests

## Обзор

Документ описывает метрики и критерии для выбора Merge Requests, которые максимально полно проверяют навыки ревью кандидата.

## 1. Технические метрики

### 1.1. Сложность кода (Code Complexity)

**Метрики:**
- **Цикломатическая сложность** (Cyclomatic Complexity)
  - Низкая: 1-10
  - Средняя: 11-20
  - Высокая: 21+
  
- **Количество изменённых файлов**
  - Простое: 1-3 файла
  - Среднее: 4-10 файлов
  - Сложное: 11+ файлов

- **Размер изменений**
  - Малое: < 100 строк
  - Среднее: 100-500 строк
  - Большое: 500+ строк

- **Глубина вложенности**
  - Простая: 1-2 уровня
  - Средняя: 3-4 уровня
  - Сложная: 5+ уровней

**Формула оценки сложности:**
```
complexity_score = (files_changed * 5) + (total_lines / 10) + (nested_depth * 3)
```

### 1.2. Тип изменений (Change Type)

**Категории:**
1. **Bug Fix** - исправление ошибок
   - Простые баги (очевидные)
   - Сложные баги (скрытые, edge cases)
   - Критические баги (security, data loss)

2. **Feature Addition** - добавление функциональности
   - Простые фичи (один файл)
   - Средние фичи (несколько файлов, модули)
   - Сложные фичи (архитектурные изменения)

3. **Refactoring** - рефакторинг кода
   - Переименование
   - Извлечение методов
   - Реструктуризация

4. **Performance Optimization** - оптимизация производительности
   - Алгоритмические улучшения
   - Оптимизация запросов
   - Кэширование

5. **Security Fix** - исправление уязвимостей
   - SQL injection
   - XSS
   - Authentication/Authorization

6. **Documentation** - документация
   - Комментарии
   - README
   - API документация

### 1.3. Язык программирования (Language)

**Приоритетные языки:**
- Python (высокий приоритет)
- JavaScript/TypeScript
- Java
- Go
- C/C++
- Rust

**Критерии:**
- Наличие MR для каждого языка
- Разнообразие языков в наборе
- Популярность языка в индустрии

### 1.4. Качество кода (Code Quality)

**Метрики:**
- **Наличие тестов**
  - Есть unit тесты
  - Есть integration тесты
  - Нет тестов

- **Покрытие тестами**
  - Высокое: > 80%
  - Среднее: 50-80%
  - Низкое: < 50%

- **Code Smells**
  - Длинные методы
  - Дублирование кода
  - Сложные условия
  - Магические числа

- **Соответствие стандартам**
  - PEP 8 (Python)
  - ESLint (JavaScript)
  - Google Style Guide
  - И другие

### 1.5. Архитектурные аспекты (Architecture)

**Аспекты:**
- **Изменения в архитектуре**
  - Новые паттерны
  - Изменение структуры
  - Миграция на новую версию

- **Паттерны проектирования**
  - Singleton
  - Factory
  - Observer
  - Strategy
  - И другие

- **SOLID принципы**
  - Single Responsibility
  - Open/Closed
  - Liskov Substitution
  - Interface Segregation
  - Dependency Inversion

- **Зависимости**
  - Добавление новых зависимостей
  - Обновление зависимостей
  - Удаление зависимостей

## 2. Метрики для оценки навыков ревьюера

### 2.1. Обнаружение проблем (Issue Detection)

**Типы проблем:**
1. **Безопасность (Security)**
   - SQL injection
   - XSS
   - CSRF
   - Небезопасное хранение паролей
   - Отсутствие валидации

2. **Производительность (Performance)**
   - N+1 запросы
   - Отсутствие индексов
   - Неэффективные алгоритмы
   - Утечки памяти

3. **Поддерживаемость (Maintainability)**
   - Дублирование кода
   - Сложная логика
   - Отсутствие комментариев
   - Плохие имена переменных

4. **Функциональность (Functionality)**
   - Логические ошибки
   - Edge cases
   - Обработка ошибок
   - Валидация входных данных

**Оценка:**
- Количество реальных проблем в MR
- Сложность обнаружения проблем
- Важность проблем

### 2.2. Качество комментариев (Comment Quality)

**Критерии:**
- **Конструктивность**
  - Предложения по улучшению
  - Объяснение проблем
  - Примеры кода

- **Тон**
  - Вежливый
   - Профессиональный
   - Конструктивный

- **Детальность**
  - Поверхностные комментарии
  - Детальные объяснения
  - С примерами

### 2.3. Сложность для ревью (Review Difficulty)

**Факторы:**
- **Время на ревью**
  - Быстрое: < 15 минут
  - Среднее: 15-60 минут
  - Долгое: 60+ минут

- **Количество вопросов**
  - Нет вопросов
  - Несколько вопросов
  - Много вопросов

- **Количество итераций**
  - Одна итерация
  - Несколько итераций
  - Много итераций

## 3. Классификация MR по уровням

### 3.1. Beginner (Начальный уровень)

**Характеристики:**
- 1-3 файла изменено
- < 100 строк изменений
- Очевидные проблемы
- Один язык программирования
- Простые типы изменений (bug fix, simple feature)

**Примеры проблем:**
- Опечатки
- Очевидные баги
- Простые улучшения стиля

**Ожидаемые навыки:**
- Базовое понимание кода
- Обнаружение очевидных ошибок
- Простые предложения по улучшению

### 3.2. Intermediate (Средний уровень)

**Характеристики:**
- 3-10 файлов изменено
- 100-500 строк изменений
- Скрытые проблемы
- Возможно несколько языков
- Средние типы изменений (feature, refactoring)

**Примеры проблем:**
- Логические ошибки
- Проблемы производительности
- Архитектурные вопросы
- Edge cases

**Ожидаемые навыки:**
- Глубокое понимание кода
- Обнаружение скрытых проблем
- Предложения по архитектуре
- Понимание паттернов

### 3.3. Advanced (Продвинутый уровень)

**Характеристики:**
- 10+ файлов изменено
- 500+ строк изменений
- Архитектурные проблемы
- Множество языков/технологий
- Сложные типы изменений (major refactoring, architecture)

**Примеры проблем:**
- Критические архитектурные проблемы
- Проблемы безопасности
- Масштабируемость
- Производительность на больших данных

**Ожидаемые навыки:**
- Экспертное понимание архитектуры
- Обнаружение критических проблем
- Предложения по масштабированию
- Понимание best practices

## 4. Алгоритм выбора MR

### 4.1. Базовые критерии

1. **Разнообразие**
   - Разные языки программирования
   - Разные типы изменений
   - Разные уровни сложности

2. **Качество**
   - Реальные проблемы в коде
   - Хорошие примеры для обучения
   - Понятный контекст

3. **Репрезентативность**
   - Типичные сценарии из реальной работы
   - Актуальные технологии
   - Популярные паттерны

### 4.2. Формула оценки MR

```
score = (
    complexity_weight * complexity_score +
    quality_weight * quality_score +
    diversity_weight * diversity_score +
    relevance_weight * relevance_score
) / total_weight
```

**Веса:**
- `complexity_weight = 0.3` - Сложность важна
- `quality_weight = 0.3` - Качество важно
- `diversity_weight = 0.2` - Разнообразие важно
- `relevance_weight = 0.2` - Релевантность важна

### 4.3. Минимальный набор MR

**Для полного тестирования навыков нужно:**

1. **По языкам:**
   - Python: 3-5 MR (beginner, intermediate, advanced)
   - JavaScript: 2-3 MR
   - Java: 1-2 MR
   - Другие: по 1-2 MR

2. **По типам изменений:**
   - Bug fix: 3-5 MR
   - Feature: 3-5 MR
   - Refactoring: 2-3 MR
   - Performance: 1-2 MR
   - Security: 1-2 MR

3. **По уровням сложности:**
   - Beginner: 5-7 MR
   - Intermediate: 7-10 MR
   - Advanced: 3-5 MR

**Итого: 15-22 MR для базового набора**

## 5. Источники данных

### 5.1. GitHub

**Преимущества:**
- Большой выбор проектов
- API для автоматизации
- Метаданные и комментарии

**Стратегия поиска:**
- Популярные open-source проекты
- Фильтрация по меткам (bug, enhancement, etc.)
- Анализ комментариев в PR

### 5.2. GitLab

**Аналогично GitHub**

### 5.3. Локальные репозитории

**Преимущества:**
- Контроль над данными
- Возможность создания тестовых MR
- Анализ истории коммитов

### 5.4. Синтетические MR

**Использование:**
- Создание MR с известными проблемами
- Контролируемая сложность
- Обучение на примерах

## 6. Процесс валидации MR

### 6.1. Автоматическая валидация

1. **Проверка метрик**
   - Корректность данных
   - Полнота информации
   - Соответствие критериям

2. **Анализ diff**
   - Парсинг diff
   - Вычисление метрик
   - Обнаружение проблем

### 6.2. Ручная валидация

1. **Проверка качества**
   - Реальность проблем
   - Релевантность для обучения
   - Понятность контекста

2. **Классификация**
   - Уровень сложности
   - Тип изменений
   - Категория проблем

## 7. Метрики успешности набора MR

### 7.1. Покрытие навыков

- **Обнаружение проблем**: 80%+ проблем должны быть найдены опытным ревьюером
- **Качество комментариев**: Средний балл > 4/5
- **Время на ревью**: Соответствие оценке

### 7.2. Разнообразие

- **Языки**: Минимум 3 разных языка
- **Типы**: Все основные типы изменений
- **Уровни**: Равномерное распределение по уровням

### 7.3. Релевантность

- **Актуальность**: Использование современных технологий
- **Реалистичность**: Типичные сценарии из работы
- **Обучаемость**: Понятные примеры для обучения

